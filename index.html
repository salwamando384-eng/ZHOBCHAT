<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZHOB CHAT Register</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="login-container">
  <h2>ZHOB CHAT</h2>
  <input type="text" id="username" placeholder="Enter your name" />
  <input type="number" id="age" placeholder="Enter your age" />
  <input type="text" id="gender" placeholder="Enter your gender" />
  <input type="email" id="email" placeholder="Enter your Gmail" />
  <input type="password" id="password" placeholder="Enter your password" />
  <input type="file" id="dpUpload" accept="image/*" />
  <button id="registerBtn">Join Chat</button>
</div>

<script type="module">
const registerBtn = document.getElementById("registerBtn");
registerBtn.addEventListener("click", () => {
  const name = document.getElementById("username").value.trim();
  const age = document.getElementById("age").value.trim();
  const gender = document.getElementById("gender").value.trim();
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();
  const file = document.getElementById("dpUpload").files[0];

  if(!name || !age || !gender || !email || !password) return alert("All fields are required!");

  let dpURL = "default_dp.png";
  function saveAndGo(dp){
    localStorage.setItem("username", name);
    localStorage.setItem("age", age);
    localStorage.setItem("gender", gender);
    localStorage.setItem("email", email);
    localStorage.setItem("password", password);
    localStorage.setItem("dp", dp);
    localStorage.setItem("loggedInUser", name);
    window.location.href = "chat.html";
  }

  if(file){
    const reader = new FileReader();
    reader.onload = function(e){ saveAndGo(e.target.result); }
    reader.readAsDataURL(file);
  } else { saveAndGo(dpURL); }
});
</script>
</body>
</html>
